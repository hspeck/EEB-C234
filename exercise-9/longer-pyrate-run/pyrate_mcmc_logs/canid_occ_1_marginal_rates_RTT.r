# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.175309204848, 0.175309204848,0.176807861228,0.176807861228,0.136821318168,0.114783446095,0.0390626019924,0.0361738648596,0.0358921402045,0.0361738648596,0.0365157780024,0.0365157780024,0.0365157780024,0.0365157780024,0.0365157780024,0.0388708529469,0.0381864637973,0.0418842553069,0.0533162955106,0.0681285249973,0.0937724824303,0.0987572741394,0.0988025978049,0.101621200756,0.101072653912,0.0988025978049,0.0968977853489,0.0993466607069,0.0971716222151,0.0949401119631,0.0950457062705,0.110889296532,0.135638538328,0.1420620514,0.141623179963,0.146672286729,0.146672286729,0.135638538328,0.133141545655,0.130520218256,0.127554955125,0.127054365881,0.127554955125,0.127554955125,0.127054365881,0.117701029206,0.1094343059,0.108595999106,0.107310280408)
L_hpd_M95=c(0.353262979355, 0.353262979355,0.353262979355,0.352591727495,0.337826905756,0.337826905756,0.281940923735,0.129878828572,0.127414579689,0.127001373249,0.127489136994,0.126533170304,0.126848840497,0.127414579689,0.127414579689,0.131983263154,0.142899964249,0.173904063528,0.195895868194,0.203244956854,0.210690906154,0.210543200378,0.209911405239,0.211439072224,0.211355574011,0.209911405239,0.210933479039,0.216843394177,0.216843394177,0.230322803028,0.287327760954,0.366989093182,0.405175952294,0.411454333034,0.415155907636,0.417663404895,0.416813738473,0.406867546441,0.407128110181,0.408668899519,0.408637714274,0.413886861963,0.418706995856,0.423275162246,0.426728731569,0.435167250385,0.433824058443,0.433824058443,0.433824058443)
M_hpd_m95=c(0.846801854348, 0.846801854348,0.08592310091,0.08592310091,0.08592310091,0.085168660655,0.0822945839065,0.0783894037796,0.079661822826,0.0790799648052,0.0818560259335,0.0822945839065,0.0818560259335,0.0833370879504,0.0822945839065,0.0822945839065,0.0823751728008,0.0822945839065,0.0821738552883,0.0821738552883,0.0801202548927,0.0801202548927,0.0800954010831,0.0822423516665,0.0821738552883,0.0759379424452,0.0783051941764,0.0759379424452,0.0764278891042,0.0759379424452,0.0725136710843,0.0684583710493,0.0647702494099,0.0647702494099,0.0617929657134,0.0571141380853,0.0567973397122,0.0565564002753,0.0558042317207,0.053888503757,0.0525950202583,0.0523417539477,0.0523417539477,0.050385902692,0.0487627089204,0.0476007612483,0.0476007612483,0.0476007612483,0.0476007612483)
M_hpd_M95=c(1.51658694317, 1.51658694317,0.191366502879,0.191366502879,0.190865852077,0.191575693463,0.178525429509,0.148385045162,0.136730654192,0.131893338553,0.131893338553,0.130478044771,0.129297853124,0.129297853124,0.126466724371,0.12606780949,0.126466724371,0.126466724371,0.126466724371,0.129036623855,0.12988841928,0.12988841928,0.129297853124,0.129297853124,0.12988841928,0.124679251316,0.127476320969,0.12579845162,0.127573507625,0.127476320969,0.129918480566,0.129918480566,0.129036623855,0.129918480566,0.130132950163,0.128896001927,0.130132950163,0.130132950163,0.129918480566,0.130132950163,0.130132950163,0.130075739913,0.130600043379,0.130132950163,0.130132950163,0.130320904824,0.130320904824,0.130320904824,0.130320904824)
R_hpd_m95=c(-1.30541374706, -1.30541374706,0.0279474817085,0.0336268110662,0.0174715437675,-0.00388847367744,-0.112578656824,-0.0907614297526,-0.0806001613101,-0.0762055508738,-0.0756967074097,-0.0748776918837,-0.0748776918837,-0.0744536362113,-0.0715175783122,-0.0746482979451,-0.0701562165578,-0.0693258583786,-0.0558848850217,-0.0366834197484,-0.0228629058583,-0.0149245329881,-0.0143191523917,-0.0075626075138,-0.00752706226155,-0.00767152126173,-0.00767152126173,-0.0075626075138,-0.0075626075138,-0.013222691564,-0.00961916894226,0.000255752127015,0.0303920719306,0.0368772324602,0.0414844328606,0.0423557699037,0.0418868427633,0.0402385655823,0.0239987276262,0.0227948606655,0.0227948606655,0.0230982982318,0.0146736331671,0.0119155250489,0.0155861929121,0.00858938857423,0.00545111820284,0.00545111820284,0.00320100510428)
R_hpd_M95=c(-0.604882323252, -0.604882323252,0.241063780755,0.245293167446,0.243566109766,0.242078631502,0.191191886802,0.0397944777938,0.0314063950767,0.0324629907369,0.0312045145744,0.0314063950767,0.0314063950767,0.0308592680414,0.0325085776199,0.0312045145744,0.0454297987133,0.0739671323601,0.0955991686735,0.110308306577,0.115000749715,0.117023924326,0.113117208484,0.111085654085,0.111085654085,0.112605829148,0.114824368798,0.117834562087,0.120782062399,0.130578352461,0.192321924359,0.261860916534,0.310901654827,0.315073550491,0.325249021937,0.323533462007,0.322226956733,0.323533462007,0.311011308218,0.31463475661,0.31870352382,0.323533462007,0.320520515153,0.323349302846,0.337669061409,0.348562945107,0.354120938341,0.354120938341,0.354120938341)
L_mean=c(0.259483334986, 0.259483334986,0.259623922759,0.260298342428,0.256419718123,0.252475488147,0.115303904709,0.0750769495758,0.0744864764807,0.0743983497708,0.0744490425851,0.0744793695068,0.0744900146014,0.0745997035587,0.0746189854856,0.0750636117208,0.0783031048643,0.0956414180073,0.128883500984,0.148452521104,0.155413142397,0.156579169807,0.157043989934,0.157964440766,0.158689271115,0.159272175675,0.160060306732,0.161311806609,0.16229824962,0.165407042205,0.179622494472,0.217108942124,0.248661744144,0.260651723176,0.266671314259,0.267733228601,0.267001188873,0.267802014462,0.267177340649,0.266864186621,0.266920319839,0.267006762279,0.26687282964,0.268113424455,0.27026225825,0.27410714536,0.275198653488,0.27449031535,0.274832706378)
M_mean=c(1.19569620507, 1.19569620507,0.118513343027,0.118478044773,0.118441180998,0.118057540502,0.112787708793,0.10845877934,0.106512883135,0.105919054553,0.10552493606,0.105282543129,0.10507340253,0.104593441251,0.104275700779,0.103929063624,0.10399635853,0.104080533869,0.104074354854,0.105205256255,0.106633209172,0.10658435822,0.105585640161,0.103480944337,0.103157125303,0.102887027786,0.102778372065,0.102691469954,0.102451271185,0.102289326103,0.101586606542,0.101186414816,0.101047801556,0.100892058328,0.100739540889,0.100183105771,0.0996674424143,0.0996460038694,0.0995175799822,0.0993122694781,0.0993224346067,0.0993613568719,0.0994705795601,0.0998008804263,0.100181592716,0.100527787432,0.100527787432,0.100527787432,0.100527787432)
R_mean=c(-0.936212870082, -0.936212870082,0.141110579732,0.141820297654,0.137978537125,0.134417947645,0.00251619591676,-0.0333818297644,-0.0320264066541,-0.0315207047817,-0.0310758934746,-0.0308031736218,-0.030583387929,-0.0299937376927,-0.0296567152931,-0.0288654519035,-0.0256932536661,-0.0084391158621,0.0248091461302,0.043247264849,0.0487799332258,0.0499948115874,0.051458349773,0.0544834964297,0.0555321458113,0.0563851478891,0.0572819346662,0.058620336655,0.0598469784351,0.0631177161023,0.07803588793,0.115922527308,0.147613942588,0.159759664848,0.16593177337,0.16755012283,0.167333746459,0.168156010593,0.167659760667,0.167551917142,0.167597885233,0.167645405407,0.16740225008,0.168312544029,0.170080665534,0.173579357928,0.174670866056,0.173962527917,0.174304918946)
trans=0.5
age=(0:(49-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.478683975424), xlim = c(-51.45,2.45), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.66824563749), xlim = c(-51.45,2.45), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.43595512176, 0.389533032175), xlim = c(-51.45,2.45), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-51.45,2.45), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()
# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.132949571792, 0.132949571792,0.132949571792,0.132949571792,0.129467537919,0.0577958493194,0.054411561961,0.054411561961,0.054411561961,0.054411561961,0.054411561961,0.054411561961,0.054411561961,0.054411561961,0.054411561961,0.054411561961,0.054411561961,0.054411561961,0.05634253009,0.0629306910755,0.0652593587277,0.0716146526019,0.0872000451522,0.0959802300384,0.115133101047,0.115133101047,0.115133101047,0.116499067227,0.107896390121,0.0904403086965,0.108953802537,0.143495088735,0.143495088735,0.143495088735,0.143495088735,0.143495088735,0.143495088735,0.143495088735,0.143495088735,0.143495088735,0.143495088735,0.143495088735,0.143495088735,0.143146999674,0.143146999674,0.108439576832,0.108439576832,0.0847379790705,0.108439576832,0.101917830606,0.101917830606,0.101917830606,0.101917830606,0.101917830606)
L_hpd_M95=c(0.346843260325, 0.346843260325,0.346843260325,0.346843260325,0.355558448461,0.309041425841,0.222070866993,0.144355315139,0.135227114535,0.135227114535,0.135227114535,0.133139780311,0.133139780311,0.133139780311,0.133139780311,0.133139780311,0.133139780311,0.144936906422,0.17335894373,0.197681879322,0.208288071284,0.229289240529,0.239070699559,0.239070699559,0.255191318372,0.255191318372,0.255191318372,0.258518269085,0.258518269085,0.283705491114,0.354691927602,0.403019998495,0.396291653603,0.399274818974,0.396291653603,0.396291653603,0.396291653603,0.396291653603,0.403019998495,0.403019998495,0.432386803672,0.436668451315,0.437151289913,0.437151289913,0.436668451315,0.409942027684,0.425993584634,0.410920290959,0.437151289913,0.437151289913,0.437151289913,0.437151289913,0.437151289913,0.437151289913)
M_hpd_m95=c(0.901246286244, 0.901246286244,0.0884940387771,0.0884940387771,0.0869493899102,0.0884940387771,0.0816677840042,0.0869493899102,0.0869493899102,0.0869493899102,0.0869493899102,0.0869493899102,0.0869493899102,0.0789225649017,0.0787244404096,0.0718027969585,0.0718027969585,0.07311944181,0.07311944181,0.07311944181,0.07311944181,0.07311944181,0.07311944181,0.07311944181,0.07311944181,0.0741357383649,0.0741357383649,0.0741357383649,0.0741357383649,0.0741357383649,0.0741357383649,0.0741357383649,0.0741357383649,0.0741357383649,0.0741357383649,0.0741357383649,0.0741357383649,0.0741357383649,0.0741357383649,0.0741357383649,0.07311944181,0.07311944181,0.07311944181,0.07311944181,0.07311944181,0.07311944181,0.07311944181,0.07311944181,0.07311944181,0.07311944181,0.07311944181,0.07311944181,0.07311944181,0.07311944181)
M_hpd_M95=c(1.59981322297, 1.59981322297,0.159740653476,0.15725836012,0.15725836012,0.15725836012,0.14779966188,0.151123789918,0.151123789918,0.151123789918,0.151123789918,0.151123789918,0.151123789918,0.140711210258,0.139755570988,0.129168404011,0.123226866831,0.121519957304,0.121519957304,0.121519957304,0.121519957304,0.121519957304,0.121519957304,0.121519957304,0.121519957304,0.122819255927,0.122819255927,0.122819255927,0.122819255927,0.122819255927,0.122819255927,0.122819255927,0.122819255927,0.122819255927,0.122819255927,0.122819255927,0.123226866831,0.123226866831,0.123226866831,0.123226866831,0.123226866831,0.123226866831,0.123226866831,0.123226866831,0.123226866831,0.123226866831,0.123226866831,0.123226866831,0.123226866831,0.123226866831,0.123226866831,0.123226866831,0.123226866831,0.123226866831)
R_hpd_m95=c(-1.31101244369, -1.31101244369,0.00988187607527,0.00988187607527,-0.0014274297693,-0.0638988210201,-0.0856814744099,-0.0833722277103,-0.0671863655036,-0.0671863655036,-0.0671863655036,-0.0671863655036,-0.0671863655036,-0.061643943786,-0.0620888591916,-0.0588635811941,-0.0580650568686,-0.0588635811941,-0.0588635811941,-0.0416320851581,-0.0385600614851,-0.0269800724153,-0.0205589444205,0.00342768878429,0.010793552137,0.010793552137,0.010793552137,0.0157955747396,0.00342768878429,0.010793552137,0.0197544622215,0.0197544622215,0.020244508696,0.020244508696,0.0215963249902,0.037572653644,0.036648010376,0.036648010376,0.0123106573227,0.0123106573227,0.0123106573227,0.0123106573227,0.00674245460072,0.00674245460072,0.0123106573227,0.0123106573227,0.00674245460072,-0.00478978905364,-0.0237599717845,-0.0237599717845,-0.0119671260973,-0.0119671260973,-0.0119671260973,-0.0119671260973)
R_hpd_M95=c(-0.652006171217, -0.652006171217,0.249884481996,0.249884481996,0.256955844112,0.209846853029,0.126071036921,0.0339278977981,0.0386381688715,0.0339278977981,0.0339278977981,0.0324546637207,0.0324546637207,0.0340071383005,0.0286676457615,0.030803567532,0.0286676457615,0.0386381688715,0.0765776623172,0.0932927244967,0.108022905815,0.143013190676,0.143013190676,0.153900603903,0.153900603903,0.153900603903,0.153900603903,0.163392059277,0.172133516314,0.222943276803,0.274506708646,0.280991442614,0.280991442614,0.284424284833,0.284424284833,0.308565009015,0.308565009015,0.308565009015,0.296813055913,0.296813055913,0.308565009015,0.311607600336,0.311607600336,0.311607600336,0.311607600336,0.311607600336,0.311607600336,0.308008391083,0.311607600336,0.311607600336,0.328384472335,0.328384472335,0.328384472335,0.328384472335)
L_mean=c(0.257688864239, 0.257688864239,0.257688864239,0.257688864239,0.253728830173,0.179976070268,0.0992394157298,0.0899290696189,0.0880334910637,0.0877379832843,0.0877346666453,0.0871531934751,0.0871531934751,0.0872705665116,0.0872705665116,0.0872705665116,0.0874608398808,0.0902043956736,0.0990243012753,0.111754490446,0.136666653756,0.159128359122,0.171045734272,0.175737624259,0.178963620887,0.178963620887,0.179629230482,0.18115408431,0.185702076936,0.197481465352,0.226842179985,0.234405547217,0.235850527524,0.240070234841,0.243561943623,0.246164483145,0.245924033434,0.246784014184,0.247433949045,0.248539381591,0.250649040547,0.256186056827,0.256838028755,0.26029234621,0.260147514798,0.253164748384,0.245031342065,0.245892576542,0.245521689571,0.243771086307,0.244276472016,0.243512849085,0.243512849085,0.243512849085)
M_mean=c(1.21898386275, 1.21898386275,0.120022107707,0.119893990059,0.119643310277,0.118435922216,0.115285962962,0.114558821286,0.114558821286,0.114485005647,0.114485005647,0.114485005647,0.114091305399,0.109569851756,0.107356958346,0.103850679791,0.101531530203,0.100482341427,0.100444027906,0.1003128298,0.1003128298,0.1003128298,0.1003128298,0.1003128298,0.1003128298,0.100326993375,0.100326993375,0.100326993375,0.10031277848,0.10031277848,0.10031277848,0.10031277848,0.10031277848,0.10031277848,0.100344221629,0.100344221629,0.100562051521,0.100562051521,0.100562051521,0.100562051521,0.100740928449,0.100740928449,0.100740928449,0.100740928449,0.100740928449,0.100740928449,0.100740928449,0.100740928449,0.100740928449,0.100740928449,0.100740928449,0.100740928449,0.100740928449,0.100740928449)
R_mean=c(-0.961294998513, -0.961294998513,0.137666756532,0.137794874181,0.134085519896,0.0615401480515,-0.0160465472322,-0.024629751667,-0.0265253302222,-0.026747022363,-0.0267503390021,-0.0273318121722,-0.0269381119241,-0.0222992852443,-0.0200863918346,-0.0165801132794,-0.0140706903227,-0.0102779457534,-0.00141972663039,0.0114416606459,0.0363538239557,0.0588155293215,0.0707329044714,0.0754247944588,0.0786507910869,0.0786366275122,0.0793022371068,0.0808270909349,0.0853892984555,0.0971686868717,0.126529401505,0.134092768737,0.135537749043,0.139757456361,0.143217721994,0.145820261516,0.145361981913,0.146221962663,0.146871897523,0.14797733007,0.149908112098,0.155445128378,0.156097100306,0.159551417761,0.159406586349,0.152423819935,0.144290413616,0.145151648093,0.144780761122,0.143030157858,0.143535543567,0.142771920636,0.142771920636,0.142771920636)
trans=0.5
age=(0:(54-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.480866418905), xlim = c(-56.7,2.7), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.75979454527), xlim = c(-56.7,2.7), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.44211368806, 0.361222919568), xlim = c(-56.7,2.7), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-56.7,2.7), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()